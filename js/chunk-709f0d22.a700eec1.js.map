{"version":3,"sources":["webpack:///./src/views/login/index.vue?7b7a","webpack:///./node_modules/core-js/modules/es6.function.name.js","webpack:///./src/views/login/index.vue?5924","webpack:///src/views/login/index.vue","webpack:///./src/views/login/index.vue?5b56","webpack:///./src/views/login/index.vue","webpack:///./src/api/user.js"],"names":["dP","f","FProto","Function","prototype","nameRE","NAME","configurable","get","this","match","e","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","directives","name","rawName","value","expression","errors","first","model","callback","$$v","mobile","code","isLoading","on","login","_v","staticRenderFns","data","methods","setRule","custom","required","$validator","localize","dict","mounted","component","userLogin","request","method","url","followUser","userid","target","userInfo","editProfile","editPhoto","photo","fd","FormData","append"],"mappings":"2IAAA,yBAAgiB,EAAG,G,uBCAniB,IAAIA,EAAK,EAAQ,QAAgBC,EAC7BC,EAASC,SAASC,UAClBC,EAAS,wBACTC,EAAO,OAGXA,KAAQJ,GAAU,EAAQ,SAAqBF,EAAGE,EAAQI,EAAM,CAC9DC,cAAc,EACdC,IAAK,WACH,IACE,OAAQ,GAAKC,MAAMC,MAAML,GAAQ,GACjC,MAAOM,GACP,MAAO,Q,2CCZb,IAAIC,EAAS,WAAa,IAAIC,EAAIJ,KAASK,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,mBAAmB,CAACF,EAAG,cAAc,CAACG,MAAM,CAAC,MAAQ,QAAQH,EAAG,iBAAiB,CAACA,EAAG,YAAY,CAACI,WAAW,CAAC,CAACC,KAAK,WAAWC,QAAQ,aAAaC,MAAM,WAAaC,WAAW,eAAeL,MAAM,CAAC,MAAQ,MAAM,KAAO,SAAS,YAAc,SAAS,gBAAgBN,EAAIY,OAAOC,MAAM,WAAWC,MAAM,CAACJ,MAAOV,EAAU,OAAEe,SAAS,SAAUC,GAAMhB,EAAIiB,OAAOD,GAAKL,WAAW,YAAYR,EAAG,YAAY,CAACI,WAAW,CAAC,CAACC,KAAK,WAAWC,QAAQ,aAAaC,MAAM,WAAaC,WAAW,eAAeL,MAAM,CAAC,MAAQ,MAAM,KAAO,OAAO,YAAc,SAAS,gBAAgBN,EAAIY,OAAOC,MAAM,SAASC,MAAM,CAACJ,MAAOV,EAAQ,KAAEe,SAAS,SAAUC,GAAMhB,EAAIkB,KAAKF,GAAKL,WAAW,WAAW,GAAGR,EAAG,MAAM,CAACE,YAAY,aAAa,CAACF,EAAG,aAAa,CAACG,MAAM,CAAC,KAAO,OAAO,KAAO,QAAQ,QAAUN,EAAImB,UAAU,eAAe,UAAUC,GAAG,CAAC,MAAQpB,EAAIqB,QAAQ,CAACrB,EAAIsB,GAAG,SAAS,IAAI,IACv9BC,EAAkB,G,oCCoCtB,GACEC,KADF,WAEI,MAAO,CACLP,OAAQ,cACRC,KAAM,SACNC,WAAW,IAGfM,QAAS,CAEPC,QAFJ,WAGM,IAAN,GACQC,OAAQ,CACNV,OAAQ,CACNW,SAAU,WAEZV,KAAM,CACJU,SAAU,YAKhBhC,KAAKiC,WAAWC,SAAS,QAASC,IAEpC,MAhBJ,kKAiBA,kBAEA,8BAEA,EArBA,0CAwBA,gBACA,mBACA,iBA1BA,OAwBA,EAxBA,OA6BA,gCAEA,oBA/BA,qDAiCA,kBAjCA,gCAoCA,wBApCA,QAsCA,kBAtCA,mHAyCEC,QAjDF,WAkDIpC,KAAK8B,YCvFqV,I,wBCQ1VO,EAAY,eACd,EACAlC,EACAwB,GACA,EACA,KACA,KACA,MAIa,aAAAU,E,+OChBf,SAASC,EAAT,GAAqC,IAAhBjB,EAAgB,EAAhBA,OAAQC,EAAQ,EAARA,KAC3B,OAAOiB,eAAQ,CACbC,OAAQ,OACRC,IAAK,sBACLb,KAAM,CACJP,OAAQA,EACRC,KAAMA,KAiBZ,SAASoB,EAAWC,GAClB,OAAOJ,eAAQ,CACbC,OAAQ,OACRC,IAAK,wBACLb,KAAM,CACJgB,OAAQD,KAcd,SAASE,IACP,OAAON,eAAQ,CACbC,OAAQ,MACRC,IAAK,eAKT,SAASK,EAAT,GAA+B,IAARlC,EAAQ,EAARA,KACrB,OAAO2B,eAAQ,CACbC,OAAQ,QACRC,IAAK,qBACLb,KAAM,CACJhB,UAMN,SAASmC,EAAT,GAA8B,IAATC,EAAS,EAATA,MAKfC,EAAK,IAAIC,SAEb,OADAD,EAAGE,OAAO,QAASH,GACZT,eAAQ,CACbC,OAAQ,QACRC,IAAK,mBACLb,KAAMqB","file":"js/chunk-709f0d22.a700eec1.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=less&\"","var dP = require('./_object-dp').f;\nvar FProto = Function.prototype;\nvar nameRE = /^\\s*function ([^ (]*)/;\nvar NAME = 'name';\n\n// 19.2.4.2 name\nNAME in FProto || require('./_descriptors') && dP(FProto, NAME, {\n  configurable: true,\n  get: function () {\n    try {\n      return ('' + this).match(nameRE)[1];\n    } catch (e) {\n      return '';\n    }\n  }\n});\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"login-container\"},[_c('van-nav-bar',{attrs:{\"title\":\"登陆\"}}),_c('van-cell-group',[_c('van-field',{directives:[{name:\"validate\",rawName:\"v-validate\",value:('required'),expression:\"'required'\"}],attrs:{\"label\":\"手机号\",\"name\":\"mobile\",\"placeholder\":\"请输入手机号\",\"error-message\":_vm.errors.first('mobile')},model:{value:(_vm.mobile),callback:function ($$v) {_vm.mobile=$$v},expression:\"mobile\"}}),_c('van-field',{directives:[{name:\"validate\",rawName:\"v-validate\",value:('required'),expression:\"'required'\"}],attrs:{\"label\":\"验证码\",\"name\":\"code\",\"placeholder\":\"请输入验证码\",\"error-message\":_vm.errors.first('code')},model:{value:(_vm.code),callback:function ($$v) {_vm.code=$$v},expression:\"code\"}})],1),_c('div',{staticClass:\"btn-login\"},[_c('van-button',{attrs:{\"type\":\"info\",\"size\":\"large\",\"loading\":_vm.isLoading,\"loading-text\":\"登陆中...\"},on:{\"click\":_vm.login}},[_vm._v(\"登陆\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"login-container\">\r\n    <van-nav-bar title=\"登陆\" />\r\n\r\n    <van-cell-group>\r\n      <van-field\r\n        v-model=\"mobile\"\r\n        label=\"手机号\"\r\n        name=\"mobile\"\r\n        placeholder=\"请输入手机号\"\r\n        v-validate=\"'required'\"\r\n        :error-message=\"errors.first('mobile')\"\r\n      />\r\n      <van-field\r\n        v-model=\"code\"\r\n        label=\"验证码\"\r\n        name=\"code\"\r\n        placeholder=\"请输入验证码\"\r\n        v-validate=\"'required'\"\r\n        :error-message=\"errors.first('code')\"\r\n      />\r\n    </van-cell-group>\r\n\r\n    <div class=\"btn-login\">\r\n      <van-button\r\n        type=\"info\"\r\n        size=\"large\"\r\n        @click=\"login\"\r\n        :loading=\"isLoading\"\r\n        loading-text=\"登陆中...\"\r\n      >登陆</van-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { userLogin } from \"@/api/user\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      mobile: \"18888888886\",\r\n      code: \"246810\",\r\n      isLoading: false\r\n    };\r\n  },\r\n  methods: {\r\n    // 设置验证规则\r\n    setRule() {\r\n      const dict = {\r\n        custom: {\r\n          mobile: {\r\n            required: \"请输入手机号码\"\r\n          },\r\n          code: {\r\n            required: \"请输入验证码\"\r\n          }\r\n        }\r\n      };\r\n      // 使用自己配置的校验规则\r\n      this.$validator.localize(\"zh_CN\", dict);\r\n    },\r\n    async login() {\r\n      this.isLoading = true;\r\n      // 当点击登陆时，对手机号和验证码进行校验\r\n      let valid = this.$validator.validate();\r\n      // 当校验成功时，valid 返回 true; 校验失败时，则返回 false;\r\n      if (valid) {\r\n        try {\r\n          // 获取用户 token\r\n          const res = await userLogin({\r\n            mobile: this.mobile,\r\n            code: this.code\r\n          });\r\n          // 将用户 token 添加到 localStorage 中\r\n          this.$store.commit(\"setUser\", res);\r\n          // 跳转到 home 路由\r\n          this.$router.back();\r\n        } catch (error) {\r\n          console.log(error);\r\n        }\r\n      } else {\r\n        console.log(\"error：\", valid);\r\n      }\r\n      this.isLoading = false;\r\n    }\r\n  },\r\n  mounted() {\r\n    this.setRule();\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.login-container {\r\n  .van-nav-bar {\r\n    background-color: rgb(25, 137, 250);\r\n    .van-nav-bar__title {\r\n      color: #fff;\r\n    }\r\n  }\r\n  .btn-login {\r\n    margin: 10px;\r\n\r\n    .van-button {\r\n      border-radius: 8px;\r\n    }\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=929b5b06&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import request from '@/utils/request';\r\n\r\n// 获取或刷新用户 token\r\nfunction userLogin({ mobile, code }) {\r\n  return request({\r\n    method: 'POST',\r\n    url: 'v1_0/authorizations',\r\n    data: {\r\n      mobile: mobile,\r\n      code: code\r\n    }\r\n  });\r\n}\r\n\r\n// 取消拉黑用户\r\nfunction cancelUserblacklist(id) {\r\n  return request({\r\n    method: 'DELETE',\r\n    url: '/v1_0/user/blacklists/',\r\n    params: {\r\n      id\r\n    }\r\n  });\r\n}\r\n\r\n// 关注用户\r\nfunction followUser(userid) {\r\n  return request({\r\n    method: 'POST',\r\n    url: '/v1_0/user/followings',\r\n    data: {\r\n      target: userid\r\n    }\r\n  });\r\n}\r\n\r\n// 取消关注用户\r\nfunction unfollowUser(userid) {\r\n  return request({\r\n    method: 'DETELE',\r\n    url: `/v1_0/user/followings/${userid}`\r\n  });\r\n}\r\n\r\n// 获取用户自己信息\r\nfunction userInfo() {\r\n  return request({\r\n    method: 'GET',\r\n    url: '/v1_0/user'\r\n  });\r\n}\r\n\r\n// 编辑用户个人信息\r\nfunction editProfile({ name }) {\r\n  return request({\r\n    method: 'PATCH',\r\n    url: '/v1_0/user/profile',\r\n    data: {\r\n      name,\r\n    }\r\n  });\r\n}\r\n\r\n// 编辑用户头像\r\nfunction editPhoto({ photo }) {\r\n  // axios ---> 底层是用 XMLHttprequest 对象实现\r\n  //    ----> 默认不允许传递文件\r\n  //    ----> formDate\r\n  // 将 photo 转换为 formDate\r\n  let fd = new FormData();\r\n  fd.append(\"photo\", photo);\r\n  return request({\r\n    method: 'PATCH',\r\n    url: '/v1_0/user/photo',\r\n    data: fd\r\n  })\r\n}\r\n\r\nexport { userLogin, cancelUserblacklist, followUser, unfollowUser, userInfo, editProfile, editPhoto };"],"sourceRoot":""}