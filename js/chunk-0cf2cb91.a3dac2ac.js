(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0cf2cb91"],{"1af6":function(t,e,n){var r=n("63b6");r(r.S,"Array",{isArray:n("9003")})},"20fd":function(t,e,n){"use strict";var r=n("d9f6"),a=n("aebd");t.exports=function(t,e,n){e in t?r.f(t,e,a(0,n)):t[e]=n}},2423:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"f",(function(){return i})),n.d(e,"g",(function(){return c})),n.d(e,"h",(function(){return s})),n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return l})),n.d(e,"e",(function(){return h}));var r=n("b775");function a(t){var e=t.channel_id,n=t.timestamp,a=t.with_top;return Object(r["a"])({method:"GET",url:"/v1_1/articles",params:{channel_id:e,timestamp:n,with_top:a}})}function i(t){return Object(r["a"])({method:"POST",url:"/v1_0/article/dislikes",data:{target:t}})}function c(t){var e=t.target,n=t.type;return console.log(e,n),Object(r["a"])({method:"POST",url:"/v1_0/article/reports",data:{target:e,type:n,remark:"sb"}})}function s(t){return Object(r["a"])({method:"GET",url:"/v1_0/suggestion",params:{q:t}})}function o(t){var e=t.page,n=t.per_page,a=t.q;return Object(r["a"])({method:"GET",url:"/v1_0/search",params:{page:e,per_page:n,q:a}})}function u(t){return Object(r["a"])({method:"GET",url:"/v1_0/articles/".concat(t)})}function l(t){return Object(r["a"])({method:"POST",url:"/v1_0/article/dislikes",data:{target:t}})}function h(t){return Object(r["a"])({method:"POST",url:"/v1_0/article/likings",data:{target:t}})}},"2fdb":function(t,e,n){"use strict";var r=n("5ca1"),a=n("d2c8"),i="includes";r(r.P+r.F*n("5147")(i),"String",{includes:function(t){return!!~a(this,t,i).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},5147:function(t,e,n){var r=n("2b4c")("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,!"/./"[t](e)}catch(a){}}return!0}},"549b":function(t,e,n){"use strict";var r=n("d864"),a=n("63b6"),i=n("241e"),c=n("b0dc"),s=n("3702"),o=n("b447"),u=n("20fd"),l=n("7cd6");a(a.S+a.F*!n("4ee1")((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,a,h,f=i(t),d="function"==typeof this?this:Array,p=arguments.length,m=p>1?arguments[1]:void 0,v=void 0!==m,b=0,g=l(f);if(v&&(m=r(m,p>2?arguments[2]:void 0,2)),void 0==g||d==Array&&s(g))for(e=o(f.length),n=new d(e);e>b;b++)u(n,b,v?m(f[b],b):f[b]);else for(h=g.call(f),n=new d;!(a=h.next()).done;b++)u(n,b,v?c(h,m,[a.value,b],!0):a.value);return n.length=b,n}})},"54a1":function(t,e,n){n("6c1c"),n("1654"),t.exports=n("95d5")},6762:function(t,e,n){"use strict";var r=n("5ca1"),a=n("c366")(!0);r(r.P,"Array",{includes:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")("includes")},"75fc":function(t,e,n){"use strict";var r=n("a745"),a=n.n(r);function i(t){if(a()(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}var c=n("774e"),s=n.n(c),o=n("c8bb"),u=n.n(o);function l(t){if(u()(Object(t))||"[object Arguments]"===Object.prototype.toString.call(t))return s()(t)}function h(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function f(t){return i(t)||l(t)||h()}n.d(e,"a",(function(){return f}))},"774e":function(t,e,n){t.exports=n("d2d5")},"7abe":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home-container"},[n("van-nav-bar",{attrs:{title:"首页",fixed:""}}),n("van-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("div",{staticClass:"tabbar-right-icon",attrs:{slot:"nav-right"},on:{click:function(e){t.show=!0}},slot:"nav-right"},[n("van-icon",{attrs:{name:"wap-nav"}})],1),t._l(t.channelList,(function(e,r){return n("van-tab",{key:e.id,attrs:{title:e.name,name:r}},[n("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.pullLoading,callback:function(e){t.pullLoading=e},expression:"pullLoading"}},[n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.dragLoading,callback:function(e){t.dragLoading=e},expression:"dragLoading"}},t._l(e.articles,(function(e,r){return n("van-cell",{key:r,attrs:{title:e.title}},[n("template",{slot:"label"},[e.cover.type>0?n("van-grid",{attrs:{border:!1,"column-num":3}},t._l(e.cover.images,(function(t,e){return n("van-grid-item",{key:e},[n("van-image",{attrs:{src:t,"lazy-load":""}})],1)})),1):t._e(),n("div",{staticClass:"article-intro"},[n("div",{staticClass:"left"},[n("span",[t._v(t._s(e.aut_name))]),n("span",[t._v("评论 "+t._s(e.comm_count))]),n("span",[t._v(t._s(t._f("dateFormat")(e.pubdate)))])]),n("van-icon",{attrs:{name:"close"},on:{click:function(n){return t.openMore(e.art_id)}}})],1)],1)],2)})),1)],1)],1)}))],2),n("channel",{attrs:{channelArr:t.channelList,activeName:t.activeName},on:{"update:channelArr":function(e){t.channelList=e},"update:channel-arr":function(e){t.channelList=e},"update:activeName":function(e){t.activeName=e},"update:active-name":function(e){t.activeName=e}},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}}),n("more",{attrs:{artId:t.art_id},model:{value:t.moreShow,callback:function(e){t.moreShow=e},expression:"moreShow"}})],1)},a=[],i=(n("ac6a"),n("75fc")),c=(n("96cf"),n("3b8d")),s=n("b775");function o(){return Object(s["a"])({method:"GET",url:"/v1_0/user/channels"})}function u(){return Object(s["a"])({method:"GET",url:"/v1_0/channels"})}function l(t){var e=t.channels;return Object(s["a"])({method:"PUT",url:"/v1_0/user/channels",data:{channels:e}})}var h=n("2423"),f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"channel-container"},[n("van-popup",{style:{height:"85%"},attrs:{value:t.value,position:"bottom",round:""},on:{input:function(e){return t.$emit("input",e)},close:t.closePopup}},[n("div",{staticClass:"channel-box"},[n("div",{staticClass:"top"},[n("div",{staticClass:"title"},[t._v("\n          我的频道\n          "),n("span",{staticClass:"sub-title"},[t._v("点击进入频道")])]),t.isEdit?n("van-button",{attrs:{round:"",type:"warning",size:"mini",plain:""},on:{click:t.editingChannel}},[t._v("编辑")]):n("van-button",{attrs:{round:"",type:"warning",size:"mini",plain:""},on:{click:t.editChannel}},[t._v("完成")])],1),n("van-grid",{attrs:{clickable:"",gutter:"7px"}},t._l(t.channelArr,(function(e,r){return n("van-grid-item",{key:e.id,staticClass:"grid-text",on:{click:function(e){return t.changeActive(r)}}},[n("div",{class:{current:r===t.activeName}},[t._v("\n            "+t._s(e.name)+"\n            "),t.isEdit||0===r?t._e():n("van-icon",{attrs:{name:"clear"},on:{click:function(e){return t.removeChannel(r)}}})],1)])})),1)],1),n("div",{staticClass:"channel-box"},[n("div",{staticClass:"top"},[n("div",{staticClass:"title"},[t._v("\n          频道推荐\n          "),n("span",{staticClass:"sub-title"},[t._v("点击添加频道")])])]),n("van-grid",{attrs:{clickable:"",gutter:"10px"}},t._l(t.otherChannel,(function(e){return n("van-grid-item",{key:e.id,staticClass:"grid-text",on:{click:function(n){return t.addChannel(e)}}},[t._v(t._s(e.name))])})),1)],1)])],1)},d=[],p=(n("6762"),n("2fdb"),{data:function(){return{isEdit:!0,channelAll:[],fakerChannel:[]}},methods:{changeActive:function(t){this.$emit("update:activeName",t)},editingChannel:function(){this.fakerChannel=Object(i["a"])(this.channelArr),this.isEdit=!1},closePopup:function(){this.isEdit||(this.$emit("update:channelArr",this.fakerChannel),this.isEdit=!0)},editChannel:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.$store.state.user,e&&e.token){t.next=5;break}this.isEdit||window.localStorage.setItem("channels",JSON.stringify(this.channelArr)),t.next=9;break;case 5:if(this.isEdit){t.next=9;break}return n=this.channelArr.slice(1).map((function(t,e){return{id:t.id,seq:e+2}})),t.next=9,l({channels:n});case 9:this.isEdit=!0;case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getAllChannelList:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u();case 2:e=t.sent,e.channels.forEach((function(t){n.$set(t,"articles",[]),n.$set(t,"pre_timestamp",0)})),this.channelAll=e.channels;case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),addChannel:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.channelArr.push(e),n=this.$store.state.user,n&&n.token){t.next=6;break}window.localStorage.setItem("channels",JSON.stringify(this.channelArr)),t.next=9;break;case 6:return r=this.channelArr.slice(1).map((function(t,e){return{id:t.id,seq:e+2}})),t.next=9,l({channels:r});case 9:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),removeChannel:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.channelArr.splice(e,1);case 1:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},props:["value","channelArr","activeName"],computed:{otherChannel:function(){var t=this.channelArr.map((function(t){return t.id})),e=this.channelAll.filter((function(e){return!t.includes(e.id)}));return e}},created:function(){this.getAllChannelList()}}),m=p,v=(n("fbc5"),n("2877")),b=Object(v["a"])(m,f,d,!1,null,null,null),g=b.exports,w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"more-container"},[n("van-dialog",{attrs:{value:t.value,showConfirmButton:!1}},[t.itemShow?n("van-cell-group",[n("van-cell",{attrs:{icon:"arrow-left",title:"返回"},on:{click:function(e){return t.$emit("input",!1)}}}),n("van-cell",{attrs:{title:"隐藏此信息",clickable:""},on:{click:t.addBlacklist}}),n("van-cell",{attrs:{title:"举报","is-link":""},on:{click:function(e){t.itemShow=!1}}}),n("van-cell",{attrs:{title:"拉黑",clickable:""},on:{click:t.addUserBlacklist}})],1):t._e(),t.itemShow?t._e():n("van-cell-group",[n("van-cell",{attrs:{icon:"arrow-left",title:"返回"},on:{click:function(e){t.itemShow=!0}}}),t._l(t.itemList,(function(e,r){return n("van-cell",{key:r,attrs:{title:e.name,clickable:""},on:{click:function(n){return t.report(e.value)}}})}))],2)],1)],1)},k=[],_={data:function(){return{show:!1,itemShow:!0,itemList:[{value:0,name:"其他问题"},{value:1,name:"标题夸张"},{value:2,name:"低俗色情"},{value:3,name:"错别字多"},{value:4,name:"旧闻重复"},{value:5,name:"广告软文"},{value:6,name:"内容不实"},{value:7,name:"涉嫌违法犯罪"},{value:8,name:"侵权"}]}},methods:{addBlacklist:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(h["f"])(this.artId);case 3:this.$emit("input",!1),this.$toast.success("成功屏蔽文章"),t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](0),this.$emit("input",!1),this.$toast.fail("屏蔽文章失败");case 11:case"end":return t.stop()}}),t,this,[[0,7]])})));function e(){return t.apply(this,arguments)}return e}(),report:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(h["g"])({target:this.artId,type:e});case 3:this.$toast.success("举报成功"),t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),t.t0.message.indexOf("409")?this.$toast.fail("已举报，请勿重复举报"):this.$toast.fail("系统异常");case 9:return t.prev=9,this.itemShow=!0,this.$emit("input",!1),t.finish(9);case 13:case"end":return t.stop()}}),t,this,[[0,6,9,13]])})));function e(e){return t.apply(this,arguments)}return e}(),addUserBlacklist:function(){this.$emit("input",!1)}},props:["value","artId"]},x=_,L=Object(v["a"])(x,w,k,!1,null,null,null),y=L.exports,O={name:"home",data:function(){return{activeName:0,dragLoading:!1,finished:!1,pullLoading:!1,show:!1,moreShow:!1,art_id:"",list:[],channelList:[]}},methods:{onLoad:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e,n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.channelList[this.activeName],n=e.id,null!==e.pre_timestamp){t.next=7;break}return this.dragLoading=!1,this.pullLoading=!1,this.finished=!0,t.abrupt("return");case 7:if(0!==e.pre_timestamp){t.next=15;break}return t.next=10,Object(h["b"])({channel_id:n,timestamp:Date.now(),with_top:1});case 10:r=t.sent,e.articles=r.results,e.pre_timestamp=r.pre_timestamp,t.next=20;break;case 15:return t.next=17,Object(h["b"])({channel_id:n,timestamp:e.pre_timestamp,with_top:1});case 17:a=t.sent,e.pre_timestamp=a.pre_timestamp,e.articles=[].concat(Object(i["a"])(e.articles),Object(i["a"])(a.results));case 20:this.dragLoading=!1,this.pullLoading=!1,this.finished=!1;case 23:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),onRefresh:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.channelList[this.activeName],n=e.id,e.articles=[],e.pre_timestamp=0,t.next=6,Object(h["b"])({channel_id:n,timestamp:Date.now(),with_top:1});case 6:r=t.sent,e.articles=r.results,this.dragLoading=!1,this.pullLoading=!1,this.finished=!1;case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getChannel:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e,n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.$store.state.user,!e){t.next=8;break}return t.next=4,o();case 4:n=t.sent,this.channelList=n.channels,t.next=17;break;case 8:if(r=JSON.parse(window.localStorage.getItem("channels")),!r){t.next=13;break}this.channelList=r,t.next=17;break;case 13:return t.next=15,o();case 15:a=t.sent,this.channelList=a.channels;case 17:this.setChannel();case 18:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),setChannel:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.channelList.forEach((function(t){e.$set(t,"articles",[]),e.$set(t,"pre_timestamp",0)}));case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),openMore:function(t){this.art_id=t,this.moreShow=!0}},created:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.getChannel();case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),components:{channel:g,more:y}},S=O,C=(n("958c"),Object(v["a"])(S,r,a,!1,null,null,null));e["default"]=C.exports},"7cbf":function(t,e,n){},9003:function(t,e,n){var r=n("6b4c");t.exports=Array.isArray||function(t){return"Array"==r(t)}},"958c":function(t,e,n){"use strict";var r=n("7cbf"),a=n.n(r);a.a},"95d5":function(t,e,n){var r=n("40c3"),a=n("5168")("iterator"),i=n("481b");t.exports=n("584a").isIterable=function(t){var e=Object(t);return void 0!==e[a]||"@@iterator"in e||i.hasOwnProperty(r(e))}},a745:function(t,e,n){t.exports=n("f410")},aae3:function(t,e,n){var r=n("d3f4"),a=n("2d95"),i=n("2b4c")("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[i])?!!e:"RegExp"==a(t))}},ac6a:function(t,e,n){for(var r=n("cadf"),a=n("0d58"),i=n("2aba"),c=n("7726"),s=n("32e9"),o=n("84f2"),u=n("2b4c"),l=u("iterator"),h=u("toStringTag"),f=o.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=a(d),m=0;m<p.length;m++){var v,b=p[m],g=d[b],w=c[b],k=w&&w.prototype;if(k&&(k[l]||s(k,l,f),k[h]||s(k,h,b),o[b]=f,g))for(v in r)k[v]||i(k,v,r[v],!0)}},c8bb:function(t,e,n){t.exports=n("54a1")},cb7cd:function(t,e,n){},d2c8:function(t,e,n){var r=n("aae3"),a=n("be13");t.exports=function(t,e,n){if(r(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(a(t))}},d2d5:function(t,e,n){n("1654"),n("549b"),t.exports=n("584a").Array.from},f410:function(t,e,n){n("1af6"),t.exports=n("584a").Array.isArray},fbc5:function(t,e,n){"use strict";var r=n("cb7cd"),a=n.n(r);a.a}}]);
//# sourceMappingURL=chunk-0cf2cb91.a3dac2ac.js.map